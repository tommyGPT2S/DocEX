# Database configuration
database:
  type: sqlite
  
  # SQLite configuration
  sqlite:
    path: docex.db
    # Path template for multi-tenancy (tenant_id is resolved at runtime)
    path_template: "storage/tenant_{tenant_id}/docex.db"
    
  # PostgreSQL configuration
  postgres:
    host: localhost
    port: 5432
    database: docex
    user: postgres
    password: postgres
    # Schema template for multi-tenancy (tenant_id is resolved at runtime)
    schema_template: "tenant_{tenant_id}"  # Schema name pattern per tenant
    
  # Common settings
  echo: true  # Enable SQL query logging
  pool_size: 5
  max_overflow: 10
  pool_timeout: 30
  pool_recycle: 3600

# Security and multi-tenancy configuration
security:
  # Multi-tenancy model: "row_level" (Model A) or "database_level" (Model B)
  # Note: v3.0 uses 'multi_tenancy' section below instead
  multi_tenancy_model: row_level
  
  # Enable automatic database routing based on tenant_id (for database_level model)
  tenant_database_routing: false
  
  # User context enforcement (for row_level model)
  enforce_user_context: false
  context_match_fields:
    - tenant_id

# DocEX 3.0 Multi-tenancy Configuration
multi_tenancy:
  # Enable v3.0 explicit multi-tenancy (requires explicit tenant provisioning)
  enabled: false
  
  # Isolation strategy: 'schema' (PostgreSQL) or 'database' (SQLite)
  isolation_strategy: schema
  
  # Bootstrap tenant configuration
  bootstrap_tenant:
    id: _docex_system_
    display_name: DocEX System
    schema: docex_system  # PostgreSQL schema name
    database_path: storage/_docex_system_/docex.db  # SQLite database path

# Application settings
app:
  name: DocEX
  version: 1.0.0
  debug: true
  log_level: DEBUG 

storage:
  type: filesystem
  filesystem:
    path: storage/docex
  
  # S3 storage configuration (when type: s3)
  s3:
    bucket: my-documents-bucket  # Required: S3 bucket name
    app_name: my-organization   # Business identifier (organization, business unit, or deployment name)
    prefix: production            # Optional: Environment prefix (e.g., dev, staging, production)
    region: us-east-1
    # Note: tenant_id is automatically added to prefix at runtime
    # Final prefix structure: {app_name}/{prefix}/tenant_{tenant_id}/
    # Examples:
    #   - Organization: "acme-corp"
    #   - Business Unit: "finance-department"
    #   - Deployment: "production-instance"

logging:
  level: DEBUG
  file: docex.log 